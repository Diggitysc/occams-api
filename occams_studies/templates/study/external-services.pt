<html i18n:domain="occams.studies" metal:use-macro="load: ../master.pt">
  <metal:content-slot fill-slot="content-slot">
    <header class="page-header">
      <div class="btn-toolbar pull-right">
        <button class="btn btn-default">
          <span class="fa fa-plus"></span>
          Create External Service
        </button>
      </div>
      <h1 i18n:translate="">${context.title}</h1>
      <ul metal:use-macro="load: header-details-server.pt" />
      <nav metal:use-macro="load: header-nav.pt" />
    </header>

    <!-- ko ifnot: isReady -->
    <div class="text-center"><span class="fa fa-refresh fa-spin"></span></div>
    <!-- /ko -->

    <div  style="display: none;" data-bind="visible: isReady">

      <!-- ko if: hasExternalServices -->
      <table class="table table-bordered table-hover table-striped">
        <thead>
          <tr>
            <th i18n:translate="">Title</th>
            <th i18n:translate="">Description</th>
            <th i18n:translate="">Url Template</th>
            <th i18n:translate="">Options</th>
          </tr>
        </thead>
        <tbody data-bind="foreach: externalServices">
          <tr>
            <td data-bind="text: title"></td>
            <td data-bind="text: description"></td>
            <td data-bind="text: url_template"></td>
            <td>
              <div class="of-controls btn-group">
                <button type="button" class="btn btn-default" data-bind="click: $root.startDelete">
                  <span class="glyphicon glyphicon-trash"></span>
                </button>
                <button type="button" class="btn btn-default" data-bind="click: $root.startEdit">
                  <span class="glyphicon glyphicon-pencil"></span>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- /ko -->

      <!-- ko ifnot: hasExternalServices -->
      <div i18n:translate="">There are no external services configured for this study.</div>
      <!-- /ko -->

    </div>

  </metal:content-slot>

  <metal:content-slot fill-slot="javascript-slot">
    <script>
      $(function(){
        var serviceUrl = "${request.current_route_path(_route_name='studies.external_services')}";
        ko.applyBindings(new ExternalServicesView({'serviceUrl': serviceUrl}));
      });
    </script>
  </metal:content-slot>
</html>
