<div id="occams-form-editor">
  <metal:form metal:use-macro="context/@@ploneform-macros/form">
  
    <metal:title-slot metal:fill-slot="title">
      <div>
        Label edit will go here...
      </div>
    </metal:title-slot>
    
    <metal:description-slot metal:fill-slot="description">
      <div>
        Description edit will go here...
      </div>
    </metal:description-slot>
    
    <metal:formtop-slot metal:fill-slot="formtop">
      <!-- TODO: version selector -->
        
      <!-- Field types -->
      <div id="occams-form-types">
        <ul>
          <tal:block tal:repeat="type_ view/types">
            <li class="" tal:attributes="class type_/token" tal:content="type_/title">Type</li>
          </tal:block>
        </ul>
      </div>
    </metal:formtop-slot>
  
    <metal:fields-slot metal:fill-slot="fields">
      <div id="occams-form-fields">
        <tal:block tal:repeat="group groups">
          <div class="occams-form-subform">
            <tal:block 
                define="
                    title   group/label;
                    version string: 2011-05-01
                ">
                <div class="occams-form-metadata">
                  <div class="occams-form-title" tal:content="title">Title</div>
                  <div class="occams-form-version" tal:content="version">Version</div>
                  <div class="occams-form-controls">
                    <ul>
                      <li><a href="edit.html" class="occams-form-edit">Edit</a></li>
                      <li><a href="delete.html" class="occams-form-delete">Delete</a></li>
                    </ul>
                  </div>
                </div>
            </tal:block>
            <div 
                class="occams-form-element-description"
                tal:define="group_description group/description|nothing"
                tal:condition="group_description"
                tal:content="structure group_description">
              Description
            </div>
            <tal:widgets repeat="widget group/widgets/values">
              <div class="occams-form-field">
                <tal:block define="
                    title   widget/field/__name__;
                    version string: 2011-05-01
                    ">
                  <tal:comment tal:replace="nothing">
                    It would be nice to replace the block below with a macro
                    re-using the code from above, unfortunately TAL makes
                    it next to fucking impossible to do it...
                  </tal:comment>
                  <div class="occams-form-metadata">
                    <div class="occams-form-title" tal:content="title">Title</div>
                    <div class="occams-form-version" tal:content="version">Version</div>
                    <div class="occams-form-controls">
                      <ul>
                        <li><a href="edit.html" class="occams-form-edit">Edit</a></li>
                        <li><a href="delete.html" class="occams-form-delete">Delete</a></li>
                      </ul>
                    </div>
                  </div>
                </tal:block>
                <div class="occams-form-widget">
                  <tal:widget tal:replace="structure widget/@@ploneform-render-widget"/>
                </div>
              </div>                    
            </tal:widgets>
          </div>
        </tal:block>
      </div>
    </metal:fields-slot>
    
  </metal:form>
</div>