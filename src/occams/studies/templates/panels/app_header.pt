<nav
    class="navbar navbar-default navbar-static-top"
    role="navigation"
    i18n:domain="occams.studies"
    tal:define="user request.user|nothing;">

  <div class="container">

    <div class="navbar-header">
      <button
          type="button"
          class="navbar-toggle"
          data-toggle="collapse"
          data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand"
          href="${request.route_path('home')}">OCCAMS Studies</a>
    </div> <!--/.navbar-header -->

    <div class="collapse navbar-collapse">

      <ul class="nav navbar-nav"
          tal:define="section request.current_route_path()">
        <li tal:define="url request.route_path('export_home')"
            tal:attributes="class python:'active' if url in section else ''"
            tal:condition="request.has_permission('fia_view')"
            class="dropdown">
          <a  id="exports-dropdown"
              href="${url}"
              data-toggle="dropdown">Exports <span class="caret"></span></a>
          <ul class="dropdown-menu"
              role="menu"
              aria-labelledby="exports-dropdown">
            <li role="presentation"
                tal:define="route string:export_home"
                class="${'active' if request.matched_route.name == route
                                  else ''}">
              <a  role="menuitem"
                  tabindex="-1"
                    href="${request.route_path(route)}">Overview</a>
            </li>
            <li role="presentation"
                tal:define="route string:export_add"
                class="${'active' if request.matched_route.name == route
                                  else ''}">
              <a  role="menuitem"
                  tabindex="-1"
                  href="${request.route_path(route)}">Create an Export</a>
            </li>
            <li role="presentation"
                tal:define="route string:export_status"
                class="${'active' if request.matched_route.name == route
                                  else ''}">
              <a  role="menuitem"
                  tabindex="-1"
                  href="${request.route_path(route)}">My Exports</a>
            </li>
            <li role="presentation"
                tal:define="route string:export_codebook"
                class="${'active' if request.matched_route.name == route
                                  else ''}">
              <a  role="menuitem"
                  tabindex="-1"
                  href="${request.route_path(route)}">Codebook</a>
            </li>
            <li role="presentation"
                tal:define="route string:export_faq"
                class="${'active' if request.matched_route.name == route
                                  else ''}">
              <a  role="menuitem"
                  tabindex="-1"
                  href="${request.route_path(route)}">FAQ</a>
            </li>
          </ul>
        </li>
      </ul>

      <ul class="nav navbar-nav navbar-right"
          tal:define="user request.environ['repoze.who.identity']['properties']|nothing;"
            tal:condition="user">
        <li><p class="navbar-text">${user['first_name']}</p></li>
        <li class="dropdown"
            tal:condition="request.apps">
          <a href="#apps"
            role="button"
            class="dropdown-toggle"
            rel="tooltip"
            data-toggle="dropdown"
            data-placement="bottom"
            data-container="body"
            data-animation="false"
            title="Services"
            ><span class="glyphicon glyphicon-th"></span><span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="Apps Menu">
            <tal:suites repeat="suite request.apps">
              <li role="presentation" class="dropdown-header">
                ${suite['title']}
              </li>
              <tal:apps repeat="app suite['apps']">
                <li role="presentation">
                  <a href="${app['url']}" role="menuitem">${app['title']}</a>
                </li>
              </tal:apps>
              <li role="presentation" class="divider"
                  tal:condition="not:repeat.suite.end"></li>
            </tal:suites>
          </ul>
        </li>
        <li>
          <a href="${request.route_path('account_logout')}"
              rel="tooltip"
              data-placement="bottom"
              data-container="body"
              data-animation="false"
              title="Log Out"
            ><span class="glyphicon glyphicon-log-out"></span></a>
        </li>
      </ul>

    </div><!--/.nav-collapse -->

  </div>
</nav>
