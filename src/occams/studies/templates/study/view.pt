<html i18n:domain="occams.studies" metal:use-macro="load: ../master.pt">
  <metal:content-slot fill-slot="content-slot">
    <div id="study-main" style="display: none;" data-bind="visible: isReady"
        data-schedule-url="${request.current_route_path(_route_name='study_schedule')}">

      <header class="page-header" data-bind="with: study">
        <div class="btn-toolbar pull-right">
          <!-- ko ifnot: is_locked -->
            <input type="checkbox"
              data-bind="bootstrapSwitch: $root.isGridEnabled"
              data-label-text="Grid"
              />
          <!-- /ko -->
          <!-- ko if: randomization_form -->
            <button class="btn btn-default" data-bind="click: $root.uploadRIDs"><span class="fa fa-random"></span> Upload RIDs</button>
          <!-- /ko -->
          <button class="btn btn-default" data-bind="click: $root.startEditStudy"><span class="fa fa-edit"></span> Edit</button>
          <button class="btn btn-default" data-bind="click: $root.startDeleteStudy"><span class="fa fa-trash-o"></span> Delete</button>
        </div>
        <h1>
          <span data-bind="text: title"></span>
          <small>
            <!-- ko if: is_randomized -->
              <span class="fa fa-random" title="Randomized" i18n:attributes="title"></span>
            <!-- /ko -->
            <!-- ko if: is_blinded -->
              <span class="fa fa-eye-slash" title="Blinded" i18n:attributes="title"></span>
            <!-- /ko -->
            <!-- ko if: is_locked -->
              <span class="fa fa-lock" title="Locked" i18n:attributes="title"></span>
            <!-- /ko -->
          </small>
        </h1>
        <ul metal:use-macro="load: ./panels/details.pt" />
        <nav metal:use-macro="load: ./panels/nav.pt" />
      </header>

      <div id="js-schedule" class="table-responsive table-scrollable">
        <!-- Pre-generated corner -->
        <table id="js-schedule-corner" class="table table-bordered table-striped table-dimensional table-rotated-header">
          <thead>
            <!-- "width: auto" affects cell width, neect to use div -->
            <th i18n:translate=""><div class="form">Visit Forms</div></th>
          </thead>
        </table>
        <!-- Pre-generated header bar -->
        <table id="js-schedule-header" class="table table-bordered table-striped table-dimensional table-rotated-header">
          <thead>
            <tr>
              <!-- "width: auto" affects cell width, neect to use div -->
              <th i18n:translate=""><div class="form">Visit Forms</div></th>
              <!-- ko foreach: study.cycles -->
                <th class="rotated">
                  <span class="rotated-container">
                    <span class="rotated-rotate">
                      <span class="rotated-text">
                        <button class="link js-popover-trigger"
                            data-placement="bottom"
                            data-bind="
                              text: title,
                              click: $root.startViewCycle"></button>
                      </span>
                    </span>
                  </span>
                </th>
              <!-- /ko -->
              <th class="rotated">
                <div class="rotated-container">
                  <div class="rotated-rotate">
                    <span class="rorated-text">
                      <button class="btn btn-link" data-bind="click: startAddCycle">
                        <span class="fa fa-plus"></span>
                        <strong i18n:translate="">Add Cycle</strong>
                      </button>
                    </span>
                  </div>
                </div>
              </th>
            </tr>
          </thead>
        </table>
        <!-- Pre-generated side bar -->
        <table id="js-schedule-sidebar" class="table table-bordered table-striped table-dimensional table-rotated-header">
          <tbody>
            <!-- ko foreach: {data: study.forms , as: 'form'} -->
              <tr>
                <th>
                  <div class="form clearfix">
                    <div class="pull-right">
                      <!-- ko if: hasMultipleVersions -->
                        <span class="badge" data-bind="text: versionsLength"></span>
                      <!-- /ko -->
                    </div>
                    <button class="link" data-bind="click: $root.startViewForm, text: title"></button>
                  </div>
                </th>
              </tr>
            <!-- /ko -->
            <tr>
              <th>
                <button class="btn btn-link" data-bind="click: $root.startAddForm">
                  <span class="fa fa-plus"></span>
                  <strong i18n:translate="">Add Form</strong>
                </button>
              </th>
            </tr>
          </tbody>
        </table>
        <!-- Main data table -->
        <table id="js-schedule-table" class="table table-bordered table-striped table-dimensional table-rotated-header">
          <thead>
            <tr>
              <!-- "width: auto" affects cell width, neect to use div -->
              <th i18n:translate=""><div class="form">Visit Forms</div></th>
              <!-- ko foreach: study.cycles -->
                <th class="rotated js-popover">
                  <span class="rotated-container">
                    <span class="rotated-rotate">
                      <span class="rotated-text">
                        <button class="link js-popover-trigger"
                            data-placement="bottom"
                            data-bind="
                              text: title,
                              click: $root.startViewCycle"></button>
                      </span>
                    </span>
                  </span>
                </th>
              <!-- /ko -->
              <th class="rotated">
                <div class="rotated-container">
                  <div class="rotated-rotate">
                    <span class="rorated-text">
                      <button class="btn btn-link" data-bind="click: startAddCycle">
                        <span class="fa fa-plus"></span>
                        <strong i18n:translate="">Add Cycle</strong>
                      </button>
                    </span>
                  </div>
                </div>
              </th>
            </tr>
          </thead>
          <tbody>
            <!-- ko foreach: {data: study.forms, as: 'form'} -->
              <tr>
                <th>
                  <div class="form clearfix">
                    <div class="pull-right">
                      <!-- ko if: hasMultipleVersions -->
                        <span class="badge" data-bind="text: versionsLength"></span>
                      <!-- /ko -->
                    </div>
                    <button class="link" data-bind="click: $root.startViewForm, text: title"></button>
                  </div>
                </th>
                <!-- ko foreach: {data: $root.study.cycles, as: 'cycle'} -->
                  <td data-bind="
                      css: {'js-clickable-cell': $root.isGridEnabled},
                      event: {dblclick: $root.toggleForm.bind($root, cycle, form)}
                      ">
                    <!-- ko if: cycle.containsForm(form) -->
                      <span class="fa fa-check"></span>
                    <!-- /ko -->
                  </td>
                <!-- /ko -->
              </tr>
            <!-- /ko -->
            <tr>
              <th>
                <button class="btn btn-link" data-bind="click: $root.startAddForm">
                  <span class="fa fa-plus"></span>
                  <strong i18n:translate="">Add Form</strong>
                </button>
              </th>
            </tr>
          </tbody>
        </table>
      </div> <!-- /#js-schedule -->

      <div class="modal fade" data-bind="showModal: editableStudy, with: editableStudy">
        <div class="modal-dialog">
          <div class="modal-content">
            <form
                class="form-horizontal"
                data-factory-url="${request.route_path('studies')"
                data-bind="
                  validate: window.defaultValidationOptions,
                  submit: $root.saveStudy">
              <div class="modal-header">
                <!-- ko if: id -->
                  <h4 class="modal-title" data-bind="text: title"></h4>
                <!-- /ko -->
                <!-- ko ifnot: id -->
                  <h4 class="modal-title">New Study</h4>
                <!-- /ko -->
              </div>
              <div class="modal-body">
                <div data-bind="template: {name: 'validation-errors-template', if: $root.hasErrorMessages, data: $root.errorMessages}"></div>
                <div class="form-group">
                  <label class="col-sm-3 required" i18n:translate="">Title</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" required name="title" data-bind="value: title"/>
                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <label class="col-sm-3 required" i18n:translate="">System Name</label>
                  <div class="col-md-6">
                    <input type="text" class="form-control" required name="name" data-bind="value: name" pattern="^[a-z0-9_\-]+$" />

                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <label class="col-sm-3 required" translate="">Printed Label</label>
                  <div class="col-sm-4">
                    <input type="text" class="form-control" required name="short_title" data-bind="value: short_title"/>
                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <label class="col-sm-3 required" i18n:translate="">Code</label>
                  <div class="col-sm-3">
                    <input type="text" class="form-control" required name="code" data-bind="value: code"/>
                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <label class="col-sm-3 required" i18n:translate="">Consent Date</label>
                  <div class="col-sm-3">
                    <input type="date" class="form-control" required name="consent_date" data-bind="value: consent_date, datetimePicker: {}"/>
                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <label class="col-sm-3" i18n:translate="">Start Date</label>
                  <div class="col-sm-3">
                    <input type="date" class="form-control" name="start_date" data-bind="value: start_date, datetimePicker: {}"/>
                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <label class="col-sm-3" i18n:translate="">End Date</label>
                  <div class="col-sm-3">
                    <input type="date" class="form-control" name="end_date" data-bind="value: end_date, datetimePicker: {}"/>
                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <label class="col-sm-3" i18n:translate="">Termination Form</label>
                  <div class="col-sm-9">
                    <input type="hidden" class="form-control"
                        required
                        i18n:attributes="data-placeholder"
                        name="termination_form"
                        data-placeholder="Select a form..."
                        data-bind="
                          selectedData: termination_form,
                          dataKey: 'name',
                          dataLabel: 'titleWithVersion',
                          select2: {
                            allowClear: true,
                            ajax: {
                              data: searchTerminationParams,
                              results: searchTerminationResults
                            }
                          }" />
                  </div>
                </div><!-- /.form-group -->
                <div class="form-group">
                  <div class="col-sm-offset-3 col-sm-9">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" name="is_locked" data-bind="checked: is_locked" />
                        <span i18n:translate="">Disable data entry</span>
                      </label>
                    </div>
                  </div>
                </div> <!-- /.form-group -->
                <div class="form-group">
                  <div class="col-sm-offset-3 col-sm-9">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" name="is_randomized" data-bind="checked: is_randomized" />
                        <span i18n:translate="">Randomized</span>
                      </label>
                    </div>
                  </div>
                </div> <!-- /.form-group -->
                <!-- ko if: is_randomized -->
                  <div class="form-group">
                    <div class="col-sm-offset-3 col-sm-9">
                      <div class="checkbox">
                        <label>
                          <input type="checkbox" name="is_blinded" data-bind="checked: is_blinded" />
                          <span i18n:translate="">Blinded</span>
                        </label>
                      </div>
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <label class="col-sm-3" i18n:translate="">Randomization Form</label>
                    <div class="col-sm-9">
                      <input type="hidden" class="form-control"
                          name="randomization_form"
                          i18n:attributes="data-placeholder"
                          data-placeholder="Select a form..."
                          data-bind="
                            selectedData: randomization_form,
                            dataKey: 'name',
                            dataLabel: 'titleWithVersion',
                            select2: {
                              allowClear: true,
                              ajax: {
                                data: searchRandomizationParams,
                                results: searchRandomizationResults
                              }
                            }" />
                    </div>
                  </div><!-- /.form-group -->
                <!-- /ko -->
              </div> <!-- /.modal-body -->
              <div class="modal-footer">
                <button
                    type="button"
                    class="btn btn-link"
                    data-bind="click: $root.clear"
                    i18n:translate="">Cancel</button>
                <button type="submit" class="btn btn-primary">
                  <span i18n:translate="">Save</span>
                  <!-- ko if: $root.isSaving -->
                    <span class="fa fa-refresh fa-spin"></span>
                  <!-- /ko -->
                </button>
              </div> <!-- /.modal-footer -->
            </form>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->

      <div class="modal fade" data-bind="showModal: showDeleteStudy, if: showDeleteStudy">
        <div class="modal-dialog">
          <div class="modal-content">
            <form
                class="form-horizontal"
                data-bind="
                  with: selectedStudy,
                  submit: $root.deleteStudy">
              <div class="modal-header">
                <h4 class="modal-title" i18n:translate="">Delete study</h4>
              </div>
              <div class="modal-body">
                <div data-bind="template: {name: 'validation-errors-template', if: $root.hasErrorMessages, data: $root.errorMessages}"></div>
                <p i18n:translate="">You are about to delete the following study and all it's collected data:</p>
                <h4 data-bind="text: title"></h4>
                <p i18n:translate="">Are you sure you want to continue?</p>
              </div> <!-- /.modal-body -->
              <div class="modal-footer">
                <button
                    type="button"
                    class="btn btn-link"
                    data-bind="click: $root.clear"
                    i18n:translate="">No</button>
                <button type="submit" class="btn btn-danger">
                  <span i18n:translate="">Yes</span>
                  <!-- ko if: $root.isSaving -->
                    <span class="fa fa-refresh fa-spin"></span>
                  <!-- /ko -->
                </button>
              </div> <!-- /.modal-footer -->
            </form>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->

      <div class="modal fade" data-bind="showModal: selectedCycle, with: selectedCycle">
        <div class="modal-dialog">
          <div class="modal-content">
            <!-- ko if: $root.showViewCycle -->
              <form class="form-horizontal">
                <div class="modal-header">
                  <div class="btn-toolbar pull-right">
                    <div class="btn-group">
                      <button class="btn btn-default" data-bind="click: $root.startEditCycle"><span class="fa fa-edit"></span></button>
                      <button class="btn btn-default" data-bind="click: $root.startDeleteCycle"><span class="fa fa-trash-o"></span></button>
                    </div>
                  </div>
                  <h4 class="modal-title" data-bind="text: title"></h4>
                </div>
                <div class="modal-body">
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Title</label>
                    <div class="col-sm-10">
                      <p class="form-control-static" data-bind="text: title"></p>
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Code</label>
                    <div class="col-sm-10">
                      <p class="form-control-static"><code data-bind="text: name"></code></p>
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label" i18n:translate="">Week</label>
                    <div class="col-sm-10">
                      <!-- ko if: week -->
                        <p class="form-control-static"><code data-bind="text: week"></code></p>
                      <!-- /ko -->
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                      <div class="checkbox">
                        <label>
                          <input type="checkbox" disabled data-bind="checked: is_interim" />
                          <span i18n:translate="">Off-schedule</span>
                        </label>
                      </div>
                    </div>
                  </div> <!-- /.form-group -->
                </div> <!-- /.modal-body -->
                <div class="modal-footer">
                  <button type="button"
                      class="btn btn-link"
                      data-bind="click: $root.clear"
                      i18n:translate="">Close</button>
                </div> <!-- /.modal-footer -->
              </form>
            <!-- /ko -->
            <!-- ko if: $root.showEditCycle -->
              <form class="form-horizontal"
                  data-factory-url="${request.current_route_path('cycles')}"
                  data-bind="
                    validate: window.defaultValidationOptions,
                    submit: $root.saveCycle">
                <div class="modal-header">
                  <!-- ko if: id -->
                    <h4 class="modal-title" data-bind="text: title"></h4>
                  <!-- /ko -->
                  <!-- ko ifnot: id -->
                    <h4 class="modal-title" i18n:translate="">New Cycle</h4>
                  <!-- /ko -->
                </div>
                <div class="modal-body" data-bind="with: $root.editableCycle">
                  <!-- ko with: $root.previousCycle -->
                    <div class="alert alert-success">
                      <span i18n:translate="">Successfully added</span>
                      <strong data-bind="text: title"></strong>!
                    </div>
                  <!-- /ko -->
                  <div data-bind="template: {name: 'validation-errors-template', if: $root.hasErrorMessages, data: $root.errorMessages}"></div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Title</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" required name="title" data-bind="value: title"/>
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Code</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" required name="name" data-bind="value: name"/>
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label" i18n:translate="">Week</label>
                    <div class="col-sm-10">
                      <input type="number" step="1" class="form-control" name="week" data-bind="value: week"/>
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                      <div class="checkbox">
                        <label>
                          <input type="checkbox" name="is_interim" data-bind="checked: is_interim" />
                          <span i18n:translate="">Off-schedule</span>
                        </label>
                      </div>
                    </div>
                  </div> <!-- /.form-group -->
                </div> <!-- /.modal-body -->
                <div class="modal-footer">
                  <!-- ko ifnot: id -->
                    <label class="text-muted">
                      <input type="checkbox" name="add_another" data-bind="checked: $root.addMoreCycles" />
                      <span i18n:translate="">Add another</span>
                    </label>
                  <!-- /ko -->
                  <!-- ko if: id -->
                    <button
                        type="button"
                        class="btn btn-link"
                        data-bind="click: $root.startViewCycle"
                        i18n:translate="">Cancel</button>
                  <!-- /ko -->
                  <!-- ko ifnot: id -->
                    <button
                        type="button"
                        class="btn btn-link"
                        data-bind="click: $root.clear"
                        i18n:translate="">Cancel</button>
                  <!-- /ko -->
                  <button type="submit" class="btn btn-primary">
                    <span i18n:translate="">Save</span>
                    <!-- ko if: $root.isSaving -->
                      <span class="fa fa-refresh fa-spin"></span>
                    <!-- /ko -->
                  </button>
                </div> <!-- /.modal-footer -->
              </form>
            <!-- /ko -->
            <!-- ko if: $root.showDeleteCycle -->
              <form class="form-horizontal" data-bind="submit: $root.deleteCycle">
                <div class="modal-header">
                  <h4 class="modal-title" i18n:translate="">Delete Cycle</h4>
                </div>
                <div class="modal-body">
                  <p>
                    <span i18n:translate="">You are about to delete</span>
                    <strong data-bind="text: title"></strong>.
                    <span i18n:translate="">Are you sure you want to continue?</span>
                  </p>
                </div> <!-- /.modal-body -->
                <div class="modal-footer">
                  <button
                      type="button"
                      class="btn btn-link"
                      data-bind="click: $root.startViewCycle"
                      i18n:translate="">No</button>
                  <button type="submit" class="btn btn-danger">
                    <span i18n:translate="">Yes</span>
                    <!-- ko if: $root.isSaving -->
                      <span class="fa fa-refresh fa-spin"></span>
                    <!-- /ko -->
                  </button>
                </div> <!-- /.modal-footer -->
              </form>
            <!-- /ko -->
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->

      <div class="modal fade" data-bind="showModal: selectedForm, if: selectedForm">
        <div class="modal-dialog">
          <div class="modal-content">
            <!-- ko if: $root.showViewForm-->
              <form class="form-horizontal" data-bind="with: selectedForm">
                <div class="modal-header">
                  <div class="btn-toolbar pull-right">
                    <div class="btn-group">
                      <button class="btn btn-default" data-bind="click: $root.startEditForm"><span class="fa fa-edit"></span></button>
                      <button class="btn btn-default" data-bind="click: $root.startDeleteForm"><span class="fa fa-trash-o"></span></button>
                    </div>
                  </div>
                  <h4 class="modal-title" data-bind="text: title"></h4>
                </div>
                <div class="modal-body">
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Form</label>
                    <div class="col-sm-10">
                      <p class="form-control-static" data-bind="text: title"></p>
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Versions</label>
                    <div class="col-sm-10">
                      <!-- ko foreach: versions -->
                        <p class="form-control-static"><code data-bind="text: publish_date"></code></p>
                      <!-- /ko -->
                    </div>
                  </div> <!-- /.form-group -->
                </div> <!-- /.modal-body -->
                <div class="modal-footer">
                  <button type="button"
                      class="btn btn-link"
                      data-bind="click: $root.clear"
                      i18n:translate="">Close</button>
                </div> <!-- /.modal-footer -->
              </form>
            <!-- /ko -->
            <!-- ko if: $root.showEditForm-->
              <form class="form-horizontal"
                  action="${request.current_route_path(_route_name='study_schemata')}"
                  data-bind="
                    with: $root.editableForm,
                    validate: window.defaultValidationOptions,
                    submit: $root.saveForm">
                <div class="modal-header">
                  <h4 class="modal-title" i18n:translate="">Add form to study</h4>
                </div>
                <div class="modal-body">
                  <div data-bind="template: {name: 'validation-errors-template', if: $root.hasErrorMessages, data: $root.errorMessages}"></div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Form</label>
                    <div class="col-sm-10">
                      <input type="hidden" class="form-control"
                          required
                          i18n:attributes="data-placeholder"
                          data-placeholder="Select a form..."
                          data-bind="
                            enable: isNew,
                            selectedData: schema,
                            dataKey: 'name',
                            dataLabel: 'title',
                            select2: {
                              allowClear: true,
                              ajax: {
                                data: searchSchemaParams,
                                results: searchSchemaResults
                              }
                            }" />
                    </div>
                  </div> <!-- /.form-group -->
                  <div class="form-group">
                    <label class="col-sm-2 control-label required" i18n:translate="">Versions</label>
                    <div class="col-sm-10">
                      <input type="hidden" class="form-control"
                          i18n:attributes="data-placeholder"
                          required
                          data-placeholder="Select a version..."
                          data-bind="
                            enable: schema,
                            selectedData: versions,
                            dataKey: 'publish_date',
                            dataLabel: 'publish_date',
                            select2: {
                              multiple: true,
                              ajax: {
                                data: searchVersionsParams,
                                results: searchVersionsResults
                              }
                            }" />
                    </div>
                  </div> <!-- /.form-group -->
                </div> <!-- /.modal-body -->
                <div class="modal-footer">
                  <!-- ko if: isNew -->
                    <label class="text-muted">
                      <input type="checkbox" name="add_another" data-bind="checked: $root.addMoreForms" />
                      <span i18n:translate="">Add another</span>
                    </label>
                  <!-- /ko -->
                  <!-- ko ifnot: isNew -->
                    <button
                        type="button"
                        class="btn btn-link"
                        data-bind="click: $root.startViewForm"
                        i18n:translate="">Cancel</button>
                  <!-- /ko -->
                  <!-- ko if: isNew -->
                    <button
                        type="button"
                        class="btn btn-link"
                        data-bind="click: $root.clear"
                        i18n:translate="">Cancel</button>
                  <!-- /ko -->
                  <button type="submit" class="btn btn-primary">
                    <span i18n:translate="">Save</span>
                    <!-- ko if: $root.isSaving -->
                      <span class="fa fa-refresh fa-spin"></span>
                    <!-- /ko -->
                  </button>
                </div><!-- /.modal-footer -->
              </form>
            <!-- /ko -->
            <!-- ko if: $root.showDeleteForm-->
              <form class="form-horizontal"
                  action="${request.current_route_path(_route_name='study_schemata')}"
                  data-bind="with: selectedForm, submit: $root.deleteForm">
                <div class="modal-header">
                  <h4 class="modal-title" i18n:translate="">Remove form from study</h4>
                </div>
                <div class="modal-body">
                  <div data-bind="template: {name: 'validation-errors-template', if: $root.hasErrorMessages, data: $root.errorMessages}"></div>
                  <p>
                    <span i18n:translate="">You are about to remove</span>
                    <strong data-bind="text: title"></strong>
                    <span i18n:translate="">from this study. Are you sure you want to continue?</span>
                  </p>
                </div> <!-- /.modal-body -->
                <div class="modal-footer">
                  <button
                      type="button"
                      class="btn btn-link"
                      data-bind="click: $root.startViewForm"
                      i18n:translate="">No</button>
                  <button type="submit" class="btn btn-danger">
                    <span i18n:translate="">Yes</span>
                    <!-- ko if: $root.isSaving -->
                      <span class="fa fa-refresh fa-spin"></span>
                    <!-- /ko -->
                  </button>
                </div> <!-- /.modal-footer -->
              </form>
            <!-- /ko -->
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->

      <script id="validation-errors-template" type="text/html">
        <div class="alert alert-danger" role="alert">
          <strong>Error!</strong> <span>Could not complete request for the following reasons:</span>
          <ul data-bind="foreach: $data">
            <li data-bind="text: $data"></li>
          </ul>
        </div>
      </script>

    </div> <!-- /:isReady -->

    <tal:json define="json import:json">
      <script id="study-data" type="application/json">${json.dumps(study)}</script>
    </tal:json>

  </metal:content-slot>
</html>
