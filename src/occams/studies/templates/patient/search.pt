<html i18n:domain="occams.studies" metal:use-macro="load: ../master.pt">
  <metal:content-slot fill-slot="content-slot">

    <div id="views-patient-search">

      <p>
        <form>
          <div class="input-group input-group-lg">
            <input type="text" class="form-control" autofocus value="${request.GET['query']|nothing}" />
            <span class="input-group-btn">
              <button class="btn btn-primary" type="button"><span class="fa fa-search"></span></button>
            </span>
          </div>
        </form>
      </p>

      <hr width="100%" />

      <div style="display:none" data-bind="visible: isReady">

        <!-- ko ifnot: hasResults -->
          <div class="alert alert-warning">
            <strong i18n:translate="">No results found!</strong>
            <span i18n:translate="">Please refine your search and try again.</span>
          </div>
        <!-- /ko -->
        <!-- ko if: hasResults -->
          <!-- ko foreach: results -->
            <p>
              <h3><a href="" data-bind="attr: {href: __url__}">
                  <span data-bind="text: site.title"></span> /
                  <span data-bind="text: pid"></span>
              </a></h3>
              <div class="row text-muted">
                <div class="col-md-6">
                  <!-- ko if: references.length <= 0 -->
                    <span i18n:translate="">No references</span>
                  <!-- /ko -->
                  <!-- ko if: references.length > 0 -->
                    <dl class="dl-horizontal" data-bind="foreach: references">
                      <dt data-bind="text: reference_type.title"></dt>
                      <dd><code data-bind="text: reference_number"></code></dd>
                    </dl>
                  <!-- /ko -->
                </div>
                <div class="col-md-6">
                  <tal:comment tal:replace="nothing">
                  <!-- ko if: enrollments.length <= 0 -->
                    <span i18n:translate="">No enrollments</span>
                  <!-- /ko -->
                  <!-- ko if: enrollments.length > 0 -->
                    <dl class="dl-horizontal" data-bind="foreach: enrollments">
                      <dt data-bind="text: title"></dt>
                      <dd><code data-bind="text: reference_number"></code></dd>
                    </dl>
                  <!-- /ko -->
                  </tal:comment>
                </div>
              </div>
            </p>
            <hr width="100%" />
          <!-- /ko -->
        <!-- /ko -->

      </div> <!-- /:isReady -->
    </div>

    <tal:json define="json import: json">
      <script id="results-data" type="application/json">${json.dumps(patients)}</script>
    </tal:json>

  </metal:content-slot>
</html>
